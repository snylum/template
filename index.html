<!DOCTYPE html>
<html>
<head>
  <title>Multi Template Filler & Cleaner</title>
  <style>
    body { 
      font-family: monospace; 
      margin: 0; 
      padding: 20px; 
      display: flex; 
      gap: 20px; 
      line-height: 1.4;
    }
    .column {
      flex: 1; 
      max-width: 50%;
      padding: 20px;         
      box-sizing: border-box; 
      background: #fafafa;   
      border-radius: 8px;    
    }
    h2, h3 { margin-bottom: 10px; }
    label { display: block; margin-top: 15px; margin-bottom: 5px; }
    textarea, input { 
      width: 100%; 
      font-family: monospace; 
      font-size: 14px; 
      padding: 6px; 
      border: 1px solid #ccc; 
      border-radius: 5px; 
      resize: vertical;
    }
    textarea { height: 80px; }
    button { 
      font-family: monospace;
      font-size: 14px;
      padding: 6px 10px; 
      border: none; 
      background: #2a5a43; 
      color: white; 
      cursor: pointer; 
      border-radius: 6px; 
      margin-right: 6px;
    }
    button:hover { background: #244a38; }
    pre { 
      background: #f4f4f4; 
      padding: 8px; 
      border-radius: 5px; 
      white-space: pre-wrap; 
      font-family: monospace; 
      font-size: 14px; 
      margin-top: 8px;
      max-height: 40px;   /* preview limited height */
      overflow-y: auto;   /* scroll if long */
    }
    .btn-row { margin: 8px 0; display: flex; align-items: center; gap: 6px; }
    .checkmark {
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
      color: green;
      font-weight: bold;
    }
    .checkmark.show { opacity: 1; }
    .template-box {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 15px;
      background: #fff;
    }
  </style>
</head>
<body>
  <!-- LEFT COLUMN -->
  <div class="column">
    <h2>Template Fillers</h2>
    <div id="templateContainer"></div>
    <button onclick="addTemplateFiller()">‚ûï Add Template Filler</button>
  </div>

  <!-- RIGHT COLUMN -->
  <div class="column">
    <h2>Line Break Cleaner</h2>

    <label>Paste Text:</label>
    <textarea id="cleanInput" placeholder="Paste text with multiple line breaks..."></textarea>

    <div class="btn-row">
      <button onclick="cleanText()">üßπ Clean</button>
      <button onclick="copyCleaned()">üìã Copy Cleaned</button>
      <span id="cleanCheck" class="checkmark">‚úÖ</span>
    </div>

    <h3>Cleaned Text:</h3>
    <pre id="cleanOutput"></pre>
  </div>

  <script>
    let templateCounter = 0;

    // --- Add Template Filler ---
    function addTemplateFiller(savedData = null) {
      templateCounter++;
      const id = "template" + templateCounter;

      const container = document.createElement("div");
      container.className = "template-box";
      container.id = id;

      container.innerHTML = `
        <label>Template:</label>
        <textarea class="template">${savedData?.template || "Example: Hello {{NAME}}, welcome to {{PLACE}}"}</textarea>
        <div class="btn-row">
          <button onclick="pinTemplate('${id}')">üìå Pin</button>
          <button onclick="clearPinned('${id}')">‚ùå Clear</button>
        </div>

        <label>Placeholders (format: {{NAME}}=John):</label>
        <textarea class="placeholders" placeholder="{{X}}=value per line">${savedData?.placeholders || ""}</textarea>

        <div class="btn-row">
          <button onclick="generate('${id}')">‚ñ∂ Generate</button>
        </div>

        <h3>Output:</h3>
        <div class="btn-row">
          <button onclick="copyOutput('${id}')">üìã Copy</button>
          <span id="${id}-check" class="checkmark">‚úÖ</span>
        </div>
        <pre class="output"></pre>
      `;

      document.getElementById("templateContainer").appendChild(container);

      // Load pinned template if exists
      if (!savedData) {
        const pinned = localStorage.getItem(id);
        if (pinned) {
          const parsed = JSON.parse(pinned);
          container.querySelector(".template").value = parsed.template;
          container.querySelector(".placeholders").value = parsed.placeholders;
        }
      }
    }

    // --- Generate ---
    function generate(id) {
      const box = document.getElementById(id);
      let template = box.querySelector(".template").value;
      const placeholders = box.querySelector(".placeholders").value.split("\n");

      placeholders.forEach(line => {
        const [ph, val] = line.split("=");
        if (ph && val) {
          template = template.replaceAll(ph.trim(), val.trim());
        }
      });

      box.querySelector(".output").innerText = template;
    }

    // --- Copy with checkmark ---
    function copyOutput(id) {
      const box = document.getElementById(id);
      const text = box.querySelector(".output").innerText;
      if (text.trim()) {
        navigator.clipboard.writeText(text);
        blinkCheck(id + "-check");
      }
    }

    function copyCleaned() {
      const text = document.getElementById("cleanOutput").innerText;
      if (text.trim()) {
        navigator.clipboard.writeText(text);
        blinkCheck("cleanCheck");
      }
    }

    function blinkCheck(elId) {
      const el = document.getElementById(elId);
      el.classList.add("show");
      setTimeout(() => el.classList.remove("show"), 1200);
    }

    // --- Pin template filler ---
    function pinTemplate(id) {
      const box = document.getElementById(id);
      const data = {
        template: box.querySelector(".template").value,
        placeholders: box.querySelector(".placeholders").value
      };
      localStorage.setItem(id, JSON.stringify(data));
    }

    function clearPinned(id) {
      localStorage.removeItem(id);
    }

    // --- Cleaner ---
    function cleanText() {
      const rawText = document.getElementById("cleanInput").value;
      const cleaned = rawText.replace(/\s*\n\s*/g, " "); // line breaks ‚Üí space
      document.getElementById("cleanOutput").innerText = cleaned;
    }

    // Initialize with one template filler
    window.onload = () => addTemplateFiller();
  </script>
</body>
</html>
